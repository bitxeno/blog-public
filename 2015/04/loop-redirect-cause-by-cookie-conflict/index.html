<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='è¿‘æ’å¼€å‘çš„ä¸€ä¸ªåå°ç³»ç»Ÿï¼ˆåŸŸåï¼šadmin.test.test.comï¼‰åœ¨æ¥å…¥å…¬å¸ç»Ÿä¸€SSOæ—¶ï¼Œé‡åˆ°äº†cookieå†²çªå¼•èµ·çš„ç™»å½•å¾ªç¯é‡å®šå‘çš„bugã€‚
å…¬å¸æœ‰ä¸€ä¸ªç»Ÿä¸€çš„SSOç™»å½•é¡µé¢ï¼Œæˆ‘ä»¬å¼€å‘çš„ç³»ç»Ÿæ˜¯è·³è½¬åˆ°è¯¥é¡µé¢å®ç°ç™»å½•éªŒè¯çš„ã€‚æœ‰ç”¨æˆ·åæ˜ ç™»å½•ä¸äº†ï¼Œæµè§ˆå™¨æç¤ºå¾ªç¯é‡å®šå‘äº†ï¼ŒæŸ¥çœ‹ç”¨æˆ·æµè§ˆå™¨å‘ç°æœ‰ä¸¤ä¸ªç›¸åŒåç§°çš„session cookieï¼š
PHPSESSID=token1; path=/; expired=/; domain=.test.com PHPSESSID=token2; path=/; expired=/; domain=.test.test.com æ˜¾ç„¶è¿™ä¸¤ä¸ªcookieçš„domainå› ä¸ºéƒ½æ˜¯admin.test.test.comçš„æ ¹åŸŸåï¼Œä½¿æµè§ˆå™¨éƒ½å‘é€åˆ°phpåå°ç³»ç»Ÿäº†ã€‚ç¬¬ä¸€ä¸ªæ˜¯åå°ç³»ç»Ÿï¼ˆadmin.test.test.comï¼‰å†™å…¥çš„ï¼Œæ˜¯æ­£ç¡®çš„session idï¼Œè€Œç¬¬äºŒä¸ªæ˜¯ç”±æœªçŸ¥ç³»ç»Ÿå†™å…¥çš„ã€‚æµ‹è¯•æ‰“å°**$_COOKIE[&amp;lsquo;PHPSESSID&amp;rsquo;]**å‘ç°è¾“å‡ºæ˜¯ï¼š
token2 å¾ˆæ˜æ˜¾phpè¯»å–åˆ°äº†é”™è¯¯çš„session idï¼Œæ‰€ä»¥å¯¼è‡´ç³»ç»Ÿè¯»å–ä¸åˆ°ä¿å­˜åœ¨sessionä¸­çš„ç™»å½•ä¿¡æ¯ï¼Œè€Œè¯¯åˆ¤ç”¨æˆ·ä¸ºæœªç™»å½•ï¼Œä¹‹åå†æŠŠç”¨æˆ·è·³è½¬å›SSOç™»å½•é¡µé¢ï¼Œè·³è½¬å›SSOç³»ç»Ÿåï¼ŒSSOç³»ç»ŸçŸ¥é“ç”¨æˆ·å·²ç™»å½•è¿‡ï¼Œå†è·³è½¬å›ç³»ç»Ÿã€‚ã€‚ã€‚è¿™æ ·å°±ä¸€ç›´å¾ªç¯ä¸‹å»äº†=ã€‚=
'><title>è§£å†³cookieå†²çªå¯¼è‡´çš„ç™»å½•å¾ªç¯é‡å®šå‘</title>
<link rel=canonical href=https://blog.xenori.com/2015/04/loop-redirect-cause-by-cookie-conflict/><link rel=stylesheet href=/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css><meta property='og:title' content='è§£å†³cookieå†²çªå¯¼è‡´çš„ç™»å½•å¾ªç¯é‡å®šå‘'><meta property='og:description' content='è¿‘æ’å¼€å‘çš„ä¸€ä¸ªåå°ç³»ç»Ÿï¼ˆåŸŸåï¼šadmin.test.test.comï¼‰åœ¨æ¥å…¥å…¬å¸ç»Ÿä¸€SSOæ—¶ï¼Œé‡åˆ°äº†cookieå†²çªå¼•èµ·çš„ç™»å½•å¾ªç¯é‡å®šå‘çš„bugã€‚
å…¬å¸æœ‰ä¸€ä¸ªç»Ÿä¸€çš„SSOç™»å½•é¡µé¢ï¼Œæˆ‘ä»¬å¼€å‘çš„ç³»ç»Ÿæ˜¯è·³è½¬åˆ°è¯¥é¡µé¢å®ç°ç™»å½•éªŒè¯çš„ã€‚æœ‰ç”¨æˆ·åæ˜ ç™»å½•ä¸äº†ï¼Œæµè§ˆå™¨æç¤ºå¾ªç¯é‡å®šå‘äº†ï¼ŒæŸ¥çœ‹ç”¨æˆ·æµè§ˆå™¨å‘ç°æœ‰ä¸¤ä¸ªç›¸åŒåç§°çš„session cookieï¼š
PHPSESSID=token1; path=/; expired=/; domain=.test.com PHPSESSID=token2; path=/; expired=/; domain=.test.test.com æ˜¾ç„¶è¿™ä¸¤ä¸ªcookieçš„domainå› ä¸ºéƒ½æ˜¯admin.test.test.comçš„æ ¹åŸŸåï¼Œä½¿æµè§ˆå™¨éƒ½å‘é€åˆ°phpåå°ç³»ç»Ÿäº†ã€‚ç¬¬ä¸€ä¸ªæ˜¯åå°ç³»ç»Ÿï¼ˆadmin.test.test.comï¼‰å†™å…¥çš„ï¼Œæ˜¯æ­£ç¡®çš„session idï¼Œè€Œç¬¬äºŒä¸ªæ˜¯ç”±æœªçŸ¥ç³»ç»Ÿå†™å…¥çš„ã€‚æµ‹è¯•æ‰“å°**$_COOKIE[&amp;lsquo;PHPSESSID&amp;rsquo;]**å‘ç°è¾“å‡ºæ˜¯ï¼š
token2 å¾ˆæ˜æ˜¾phpè¯»å–åˆ°äº†é”™è¯¯çš„session idï¼Œæ‰€ä»¥å¯¼è‡´ç³»ç»Ÿè¯»å–ä¸åˆ°ä¿å­˜åœ¨sessionä¸­çš„ç™»å½•ä¿¡æ¯ï¼Œè€Œè¯¯åˆ¤ç”¨æˆ·ä¸ºæœªç™»å½•ï¼Œä¹‹åå†æŠŠç”¨æˆ·è·³è½¬å›SSOç™»å½•é¡µé¢ï¼Œè·³è½¬å›SSOç³»ç»Ÿåï¼ŒSSOç³»ç»ŸçŸ¥é“ç”¨æˆ·å·²ç™»å½•è¿‡ï¼Œå†è·³è½¬å›ç³»ç»Ÿã€‚ã€‚ã€‚è¿™æ ·å°±ä¸€ç›´å¾ªç¯ä¸‹å»äº†=ã€‚=
'><meta property='og:url' content='https://blog.xenori.com/2015/04/loop-redirect-cause-by-cookie-conflict/'><meta property='og:site_name' content="bitxeno's notes"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='php'><meta property='article:tag' content='http'><meta property='article:published_time' content='2015-04-02T00:21:00+00:00'><meta property='article:modified_time' content='2015-04-02T00:21:00+00:00'><meta name=twitter:title content="è§£å†³cookieå†²çªå¯¼è‡´çš„ç™»å½•å¾ªç¯é‡å®šå‘"><meta name=twitter:description content="è¿‘æ’å¼€å‘çš„ä¸€ä¸ªåå°ç³»ç»Ÿï¼ˆåŸŸåï¼šadmin.test.test.comï¼‰åœ¨æ¥å…¥å…¬å¸ç»Ÿä¸€SSOæ—¶ï¼Œé‡åˆ°äº†cookieå†²çªå¼•èµ·çš„ç™»å½•å¾ªç¯é‡å®šå‘çš„bugã€‚
å…¬å¸æœ‰ä¸€ä¸ªç»Ÿä¸€çš„SSOç™»å½•é¡µé¢ï¼Œæˆ‘ä»¬å¼€å‘çš„ç³»ç»Ÿæ˜¯è·³è½¬åˆ°è¯¥é¡µé¢å®ç°ç™»å½•éªŒè¯çš„ã€‚æœ‰ç”¨æˆ·åæ˜ ç™»å½•ä¸äº†ï¼Œæµè§ˆå™¨æç¤ºå¾ªç¯é‡å®šå‘äº†ï¼ŒæŸ¥çœ‹ç”¨æˆ·æµè§ˆå™¨å‘ç°æœ‰ä¸¤ä¸ªç›¸åŒåç§°çš„session cookieï¼š
PHPSESSID=token1; path=/; expired=/; domain=.test.com PHPSESSID=token2; path=/; expired=/; domain=.test.test.com æ˜¾ç„¶è¿™ä¸¤ä¸ªcookieçš„domainå› ä¸ºéƒ½æ˜¯admin.test.test.comçš„æ ¹åŸŸåï¼Œä½¿æµè§ˆå™¨éƒ½å‘é€åˆ°phpåå°ç³»ç»Ÿäº†ã€‚ç¬¬ä¸€ä¸ªæ˜¯åå°ç³»ç»Ÿï¼ˆadmin.test.test.comï¼‰å†™å…¥çš„ï¼Œæ˜¯æ­£ç¡®çš„session idï¼Œè€Œç¬¬äºŒä¸ªæ˜¯ç”±æœªçŸ¥ç³»ç»Ÿå†™å…¥çš„ã€‚æµ‹è¯•æ‰“å°**$_COOKIE[&amp;lsquo;PHPSESSID&amp;rsquo;]**å‘ç°è¾“å‡ºæ˜¯ï¼š
token2 å¾ˆæ˜æ˜¾phpè¯»å–åˆ°äº†é”™è¯¯çš„session idï¼Œæ‰€ä»¥å¯¼è‡´ç³»ç»Ÿè¯»å–ä¸åˆ°ä¿å­˜åœ¨sessionä¸­çš„ç™»å½•ä¿¡æ¯ï¼Œè€Œè¯¯åˆ¤ç”¨æˆ·ä¸ºæœªç™»å½•ï¼Œä¹‹åå†æŠŠç”¨æˆ·è·³è½¬å›SSOç™»å½•é¡µé¢ï¼Œè·³è½¬å›SSOç³»ç»Ÿåï¼ŒSSOç³»ç»ŸçŸ¥é“ç”¨æˆ·å·²ç™»å½•è¿‡ï¼Œå†è·³è½¬å›ç³»ç»Ÿã€‚ã€‚ã€‚è¿™æ ·å°±ä¸€ç›´å¾ªç¯ä¸‹å»äº†=ã€‚=
"><link rel="shortcut icon" href=/favicon.ico><meta name=referrer content="no-referrer"><link href=/index.xml rel=alternate type=application/rss+xml title="bitxeno's notes"><style>.article-page article .article-content img{max-width:720px!important;max-height:720px!important;object-fit:contain;width:100%}.article-summary-more{margin-left:5px;padding:1px 5px;border-radius:5px;border:var(--card-text-color-secondary)solid 1px;color:var(--card-text-color-secondary);font-size:.8em}.article-content code{background-color:rgba(27,31,35,5%);margin:0 2px}div.hugo-encrypt-encryption-notice{margin:1.5em 0;padding:0 var(--content-padding)}.hugo-encryptor-tips{margin-top:1.5rem;color:#797979;font-style:italic}.hugo-encrypt-form .hugo-encrypt-input{padding:4px 0;border:1px solid #f596aa;border-radius:1rem;outline:none;line-height:1.25;text-align:center;color:#4a4a4a;-webkit-appearance:none}.hugo-encrypt-form .hugo-encrypt-button{margin-left:1rem;padding:4px 16px;background-color:#fafafa;border:1px solid #fff;border-radius:1rem;box-shadow:0 1px 2px rgba(0,0,0,.3);outline:none;line-height:1.25;text-align:center;color:#e16b8c;transition:all ease-out .3s}.hugo-encrypt-form .hugo-encrypt-button:hover{background-color:#e16b8c;border-color:#e16b8c;color:#fafafa;cursor:pointer}.hugo-encrypt-input-response{margin-left:1rem;color:#f08080}div.notices.warning>blockquote{border-left:var(--blockquote-border-size)solid #f0b37e;background:#fff2db}div.notices.success>blockquote{border-left:var(--blockquote-border-size)solid rgba(92,184,92,.8);background:#e6f9e6}div.notices>blockquote{border-left:var(--blockquote-border-size)solid #6ab0de;background:#e7f2fa}div.notices.error>blockquote{border-left:var(--blockquote-border-size)solid rgba(217,83,79,.8);background:#fae2e2}</style></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu3ef0a0a31328f79e0f83bf1637b02207_76647_300x0_resize_box_3.png width=300 height=281 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>bitxeno's notes</a></h1><h2 class=site-description>simple thinking, simple life.</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>é¦–é¡µ</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>å½’æ¡£</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœç´¢</span></a></li><li><a href=/star/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-star" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 17.75l-6.172 3.245 1.179-6.873-5-4.867 6.9-1 3.086-6.253 3.086 6.253 6.9 1-5 4.867 1.179 6.873z"/></svg>
<span>æ¨è</span></a></li><li><a href=/abouts/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äº</span></a></li><li><a href=/index.xml><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg>
<span>è®¢é˜…</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://blog.xenori.com/ selected></option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%8A%80%E6%9C%AF/>æŠ€æœ¯</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/2015/04/loop-redirect-cause-by-cookie-conflict/>è§£å†³cookieå†²çªå¯¼è‡´çš„ç™»å½•å¾ªç¯é‡å®šå‘</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2015å¹´04æœˆ02å·</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 3 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>è¿‘æ’å¼€å‘çš„ä¸€ä¸ªåå°ç³»ç»Ÿï¼ˆåŸŸåï¼šadmin.test.test.comï¼‰åœ¨æ¥å…¥å…¬å¸ç»Ÿä¸€SSOæ—¶ï¼Œé‡åˆ°äº†cookieå†²çªå¼•èµ·çš„ç™»å½•å¾ªç¯é‡å®šå‘çš„bugã€‚</p><p>å…¬å¸æœ‰ä¸€ä¸ªç»Ÿä¸€çš„SSOç™»å½•é¡µé¢ï¼Œæˆ‘ä»¬å¼€å‘çš„ç³»ç»Ÿæ˜¯è·³è½¬åˆ°è¯¥é¡µé¢å®ç°ç™»å½•éªŒè¯çš„ã€‚æœ‰ç”¨æˆ·åæ˜ ç™»å½•ä¸äº†ï¼Œæµè§ˆå™¨æç¤ºå¾ªç¯é‡å®šå‘äº†ï¼ŒæŸ¥çœ‹ç”¨æˆ·æµè§ˆå™¨å‘ç°æœ‰ä¸¤ä¸ªç›¸åŒåç§°çš„session cookieï¼š</p><pre tabindex=0><code>PHPSESSID=token1; path=/; expired=/; domain=.test.com  
PHPSESSID=token2; path=/; expired=/; domain=.test.test.com
</code></pre><p>æ˜¾ç„¶è¿™ä¸¤ä¸ªcookieçš„domainå› ä¸ºéƒ½æ˜¯admin.test.test.comçš„æ ¹åŸŸåï¼Œä½¿æµè§ˆå™¨éƒ½å‘é€åˆ°phpåå°ç³»ç»Ÿäº†ã€‚ç¬¬ä¸€ä¸ªæ˜¯åå°ç³»ç»Ÿï¼ˆadmin.test.test.comï¼‰å†™å…¥çš„ï¼Œæ˜¯æ­£ç¡®çš„session idï¼Œè€Œç¬¬äºŒä¸ªæ˜¯ç”±æœªçŸ¥ç³»ç»Ÿå†™å…¥çš„ã€‚æµ‹è¯•æ‰“å°**$_COOKIE[&lsquo;PHPSESSID&rsquo;]**å‘ç°è¾“å‡ºæ˜¯ï¼š</p><pre tabindex=0><code>token2
</code></pre><p>å¾ˆæ˜æ˜¾phpè¯»å–åˆ°äº†é”™è¯¯çš„session idï¼Œæ‰€ä»¥å¯¼è‡´ç³»ç»Ÿè¯»å–ä¸åˆ°ä¿å­˜åœ¨sessionä¸­çš„ç™»å½•ä¿¡æ¯ï¼Œè€Œè¯¯åˆ¤ç”¨æˆ·ä¸ºæœªç™»å½•ï¼Œä¹‹åå†æŠŠç”¨æˆ·è·³è½¬å›SSOç™»å½•é¡µé¢ï¼Œè·³è½¬å›SSOç³»ç»Ÿåï¼ŒSSOç³»ç»ŸçŸ¥é“ç”¨æˆ·å·²ç™»å½•è¿‡ï¼Œå†è·³è½¬å›ç³»ç»Ÿã€‚ã€‚ã€‚è¿™æ ·å°±ä¸€ç›´å¾ªç¯ä¸‹å»äº†=ã€‚=</p><p>ä¸ºä»€ä¹ˆPHPä¼šè¯»å–åˆ°é”™è¯¯çš„session idå‘¢ï¼Ÿæ‰“å°å…¨å±€å˜é‡**$_SERVER[&lsquo;HTTP_COOKIES&rsquo;]**å‡ºæ¥æŸ¥çœ‹ï¼š</p><pre tabindex=0><code>PHPSESSID=token2;PHPSESSID=token1
</code></pre><p>å‘ç°PHPæ˜¯èƒ½æ¥æ”¶åˆ°ä¸¤ä¸ªåŒåCOOKIEçš„ï¼Œä½†åªå–äº†ç¬¬ä¸€ä¸ªå½“çœŸæ­£çš„session idï¼ï¼<br>æŸ¥çœ‹phpæºç ï¼Œåœ¨æ–‡ä»¶php_variables.cçš„220è¡Œï¼Œæœ‰æ³¨é‡Šå‡ºphpå¯¹åŒåcookieçš„å¤„ç†è§„åˆ™ï¼š</p><blockquote><p><a class=link href=https://github.com/php/php-src/blob/e10e151e9b92313a7085272c85bebf6c82017fce/main/php_variables.c target=_blank rel=noopener>https://github.com/php/php-src/blob/e10e151e9b92313a7085272c85bebf6c82017fce/main/php_variables.c</a> #220</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>     * According to rfc2965, more specific paths are listed above the less specific ones.
</span></span></span><span class=line><span class=cl><span class=cm>     * If we encounter a duplicate cookie name, we should skip it, since it is not possible
</span></span></span><span class=line><span class=cl><span class=cm>     * to have the same (plain text) cookie name for the same path and we should not overwrite
</span></span></span><span class=line><span class=cl><span class=cm>     * more specific cookies with the less specific ones.
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>Z_TYPE</span><span class=p>(</span><span class=nf>PG</span><span class=p>(</span><span class=n>http_globals</span><span class=p>)[</span><span class=n>TRACK_VARS_COOKIE</span><span class=p>])</span> <span class=o>!=</span> <span class=n>IS_UNDEF</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>    	<span class=n>symtable1</span> <span class=o>==</span> <span class=nf>Z_ARRVAL</span><span class=p>(</span><span class=nf>PG</span><span class=p>(</span><span class=n>http_globals</span><span class=p>)[</span><span class=n>TRACK_VARS_COOKIE</span><span class=p>])</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>    	<span class=nf>zend_symtable_str_exists</span><span class=p>(</span><span class=n>symtable1</span><span class=p>,</span> <span class=n>index</span><span class=p>,</span> <span class=n>index_len</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nf>zval_ptr_dtor</span><span class=p>(</span><span class=o>&amp;</span><span class=n>gpc_element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=n>gpc_element_p</span> <span class=o>=</span> <span class=nf>zend_symtable_str_update_ind</span><span class=p>(</span><span class=n>symtable1</span><span class=p>,</span> <span class=n>index</span><span class=p>,</span> <span class=n>index_len</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>gpc_element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>æ„æ€æ˜¯å½“phpé‡åˆ°ç›¸åŒåç§°çš„cookieæ—¶ï¼Œåªä¼šä¿ç•™**$_SERVER[&lsquo;HTTP_COOKIES&rsquo;]**ä¸­çš„ç¬¬ä¸€ä¸ªcookieï¼Œè€Œä½™ä¸‹åŒåçš„ä¼šå¿½ç•¥è·³è¿‡ã€‚</p><p>å¾ˆæ˜æ˜¾ï¼Œåªè¦æµè§ˆå™¨ä¼ cookieç»™phpæ—¶ï¼ŒæŠŠtoken1çš„session idæ”¾åœ¨æœ€å‰é¢ï¼Œè¿™æ ·å°±èƒ½æ­£ç¡®åˆ¤æ–­ç™»å½•æˆåŠŸäº†ï¼
é‚£ä¹ˆæµè§ˆå™¨ä¼ é€’cookieé¡ºåºæ˜¯å¦‚ä½•çš„å‘¢ï¼Ÿå‚è€ƒ<a class=link href=http://www.rfc-editor.org/rfc/rfc6265.txt target=_blank rel=noopener>RFC6265 HTTP State Management Mechanism</a>ï¼Œå¯ä»¥å‘ç°ï¼š</p><pre tabindex=0><code>4.2.2

   In particular,if the Cookie header contains two cookies with the same name (e.g.,
   that were set with different Path or Domain attributes), servers
   SHOULD NOT rely upon the order in which these cookies appear in the
   header.
5.3.  Storage Model

  2.  The user agent SHOULD sort the cookie-list in the following
       order:

       *  Cookies with longer paths are listed before cookies with
          shorter paths.

       *  Among cookies that have equal-length path fields, cookies with
          earlier creation-times are listed before cookies with later
          creation-times.

       NOTE: Not all user agents sort the cookie-list in this order, but
       this order reflects common practice when this document was
       written, and, historically, there have been servers that
       (erroneously) depended on this order.
</code></pre><p>å¤§æ¦‚æ„æ€å°±æ˜¯ï¼š</p><ol><li>pathè¶Šé•¿çš„è¯´æ˜åŒ¹é…è¶Šç²¾ç¡®ï¼Œé¡ºåºè¶Šé å‰</li><li>å‡å¦‚pathç›¸åŒï¼Œcookieåˆ›å»ºæ—¶é—´è¶Šæ—©çš„ï¼Œé¡ºåºè¶Šé å‰</li><li>é¡ºåºä¸domainæ²¡å…³ç³»<br>RFCåŒæ—¶ä¹Ÿè¯´æ˜å¹¶ä¸æ˜¯æ‰€æœ‰çš„æµè§ˆå™¨éƒ½éµå®ˆè¿™ä¸ªï¼Œå¹¶ä¸”æœåŠ¡å™¨ä¹Ÿä¸åº”è¯¥ä¾èµ–äºcookieå‡ºç°çš„é¡ºåºã€‚</li></ol><p>æœ€åé€šè¿‡æ›´æ”¹ä¿å­˜çš„session idåç§°æ¥é¿å…å†²çªè§£å†³é—®é¢˜ï¼Œä¸è¿‡å€’è®©æˆ‘åŠ æ·±äº†cookieçš„äº†è§£ã€‚</p></section><footer class=article-footer><section class=article-tags><a href=/tags/php/>Php</a>
<a href=/tags/http/>Http</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>æœ€åæ›´æ–°äº 2015å¹´04æœˆ02å· 00:21 UTC</span></section></footer></article><aside class=related-contents--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-contents><div class="flex article-list--tile"><article><a href=/2015/07/2015-using-gdb-to-debug-php-coredump/><div class=article-details><h2 class=article-title>ä½¿ç”¨gdbè°ƒè¯•phpçš„coredumpæ–‡ä»¶</h2></div></a></article><article><a href=/2013/11/install-php-from-source-in-ubuntu/><div class=article-details><h2 class=article-title>åœ¨ubuntuä¸­ç¼–è¯‘å®‰è£…php</h2></div></a></article><article><a href=/2013/11/handle-fatal-error-in-php/><div class=article-details><h2 class=article-title>æ•æ‰phpä¸­çš„fatal erroré”™è¯¯</h2></div></a></article><article><a href=/2024/06/capture-ubuntu-network-with-graftcp/><div class=article-details><h2 class=article-title>åœ¨ Ubuntu ä¸­ä½¿ç”¨ graftcp æŠ“å–ç¨‹åºç½‘ç»œè¯·æ±‚</h2></div></a></article><article class=has-image><a href=/2024/02/github-download-enhance-speed/><div class=article-image><img src=/2024/02/github-download-enhance-speed/cover.907d6794ed4df001931ba88a291d4e34_hu97c93a104dd71fdb6ecb2b1c8317cee1_61791_250x150_fill_box_smart1_3.png width=250 height=150 loading=lazy alt="Featured image of post github ä¸‹è½½åŠ é€Ÿ" data-key=github-download-enhance-speed data-hash="md5-kH1nlO1N8AGTG6iKKR1ONA=="></div><div class=article-details><h2 class=article-title>github ä¸‹è½½åŠ é€Ÿ</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=bitxeno/blog-public data-repo-id=R_kgDOLoFOYw data-category=Announcements data-category-id=DIC_kwDOLoFOY84CeXb1 data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=noborder_light data-lang=zh-CN crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"noborder_light":"noborder_gray")}})()</script><footer class=site-footer><section class=copyright>&copy;
2021 -
2024 bitxeno's notes</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.11.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>